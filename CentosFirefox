FROM centos:7

# https://bitbucket.org/atlassian/docker-node-jdk-chrome-firefox/src/63a535111c1da6a57071ea19e62b742e9e64ef8f/Dockerfile?at=master&fileviewer=file-view-default

RUN yum update -y
RUN yum install -y wget \
                    gtk3 \
                    libxul.so\
                    libXt \
                    xorg-x11-server-Xvfb

RUN yum groupinstall "Development tools" -y 


# Install Node
RUN curl --silent --location https://rpm.nodesource.com/setup_8.x | bash - 
RUN yum -y install nodejs

# Install Yarn
RUN curl --silent --location https://dl.yarnpkg.com/rpm/yarn.repo | tee /etc/yum.repos.d/yarn.repo
RUN yum -y install yarn

# Install Firefox
WORKDIR /usr/local
RUN wget http://ftp.mozilla.org/pub/firefox/releases/58.0/linux-x86_64/en-US/firefox-58.0.tar.bz2
RUN yum remove firefox
RUN tar xvjf firefox-58.0.tar.bz2 
RUN ln -s /usr/local/firefox/firefox /usr/bin/firefox


# Start Xvfb
ADD scripts/xvfb-firefox /usr/bin/xvfb-firefox
RUN chmod -R 755 /usr/bin/xvfb-firefox
# RUN ln -sf /usr/bin/xvfb-firefox /usr/bin/firefox


ENV FIREFOX_BIN /usr/bin/firefox



CMD ["/usr/bin/xvfb-firefox"]